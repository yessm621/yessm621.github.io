<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.23.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>쿠키와 캐시 - yessm621.dev</title>
<meta name="description" content="1. 쿠키">


  <meta name="author" content="승미">
  
  <meta property="article:author" content="승미">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="ko_KR">
<meta property="og:site_name" content="yessm621.dev">
<meta property="og:title" content="쿠키와 캐시">
<meta property="og:url" content="http://localhost:4000/http/CookieCash/">


  <meta property="og:description" content="1. 쿠키">







  <meta property="article:published_time" content="2022-07-16T00:00:00+09:00">





  

  


<link rel="canonical" href="http://localhost:4000/http/CookieCash/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "승미",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="yessm621.dev Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- 사이트 맨위에 책 모양으로  파비콘 등록-->
<link rel="apple-touch-icon" sizes="180x180" href="/assets/images/icon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/icon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/images/icon/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

<!-- end custom head snippets -->
    <!--폰트 : "Nanum Gothic Coding", "Coming Soon"-->
    <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Coming+Soon&family=Nanum+Gothic+Coding&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Coming+Soon&family=Nanum+Gothic+Coding&display=swap">
     
    <!--폰트 : "Iropke Batang"-->
    <link rel="preload" as="style" href="https://cdn.jsdelivr.net/font-iropke-batang/1.2/font-iropke-batang.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/font-iropke-batang/1.2/font-iropke-batang.css">
  </head>

  <body class="layout--single <!-- 본문 늘리기!!!-->">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/setting/logo.png" alt="yessm621.dev"></a>
        
        <a class="site-title" href="/">
          yessm621.dev
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/">Category</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tag</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">메뉴</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/setting/bio-photo.png" alt="승미" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">승미</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>공부하며 기록하는 블로그입니다.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">팔로우</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">South Korea</span>
        </li>
      

      
        
          
            <li><a href="https://github.com/yessm621" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="mailto:yessm621@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  

  <!--전체 글 수를 세기 위한 연산. sum 변수에 전체 글 수 저장-->



<nav class="nav__list">
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">메뉴</label>
  <ul class="nav__items" id="category_tag_menu">
      
      <!--전체 글 수-->
      <li>
            📂 <span style="font-family:'Cafe24Oneprettynight';">전체 글 수</style> <span style="font-family:'Coming Soon';">80</style> <span style="font-family:'Cafe24Oneprettynight';">개</style> 
      </li>

      <li>
        <!--기본 양식
         <span class="nav__sub-title">옆에 들어갈 큰 제목</span>
            <ul> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        -->
    
        <!--------------------------------------분류 시작-------------------------------------------->
        <span class="nav__sub-title">Java</span><!--큰 카테고리-->
            <!--ul 태그로 같은 카테고리들 모아둔 페이지들 나열-->

            <ul>
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Java" class="">문법(8)</a></li>
                    
                
                    
                
                    
                
            </ul>

            <ul>
                
                    
                        <li><a href="/categories/SpringBoot" class="">SpringBoot(31)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>

            <ul>
                
                    
                
                    
                        <li><a href="/categories/Jpa" class="">JPA(23)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>

            <ul>
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/TestCode" class="">테스트코드(3)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        <!--------------------------------------분류 끝-------------------------------------------->
        
        <!--------------------------------------분류 시작-------------------------------------------->
        <!-- <span class="nav__sub-title">Python</span>
            <ul>
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>     -->
        <!--------------------------------------분류 끝-------------------------------------------->

        <!--------------------------------------분류 시작-------------------------------------------->
        <span class="nav__sub-title">Series</span>
            <ul>
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Series" class="">시리즈(4)</a></li>
                    
                
            </ul>    
        <!--------------------------------------분류 끝-------------------------------------------->

        <!--------------------------------------분류 시작-------------------------------------------->
        <span class="nav__sub-title">Git</span>
            <ul>
                
                    
                
                    
                
                    
                        <li><a href="/categories/Git" class="">Git(1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>    
        <!--------------------------------------분류 끝-------------------------------------------->
        
        <!--------------------------------------분류 시작-------------------------------------------->
        <span class="nav__sub-title">CS</span>
            <ul>
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Http" class="">Http(7)</a></li>
                    
                
                    
                
            </ul>

            <ul>
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Auth" class="">인증/인가(3)</a></li>
                    
                
                    
                
                    
                
                    
                
            </ul>

        <!--------------------------------------분류 끝-------------------------------------------->


      </li>
 
  </ul>
</nav>

  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="쿠키와 캐시">
    <meta itemprop="description" content="1. 쿠키">
    <meta itemprop="datePublished" content="2022-07-16T00:00:00+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">쿠키와 캐시
</h1>
          

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> 작성일</strong> <time datetime="2022-07-16T00:00:00+09:00">July 16, 2022</time></p>

<!--작성일-->
          


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On This Page</h4></header>
              <ul class="toc__menu"><li><a href="#1-쿠키">1. 쿠키</a><ul><li><a href="#stateless">Stateless</a></li><li><a href="#11-사용법">1.1 사용법</a></li><li><a href="#12-주의사항">1.2 주의사항</a></li><li><a href="#참고-웹-스토리지web-storage">[참고] 웹 스토리지(Web Storage)</a></li><li><a href="#13-쿠키의-생명주기">1.3 쿠키의 생명주기</a></li><li><a href="#14-쿠키의-도메인">1.4 쿠키의 도메인</a></li><li><a href="#15-쿠키-경로-지정">1.5 쿠키 경로 지정</a></li><li><a href="#16-쿠키-보안-지정">1.6 쿠키 보안 지정</a></li></ul></li><li><a href="#2-캐시">2. 캐시</a><ul><li><a href="#21-캐시가-없을-때">2.1 캐시가 없을 때</a></li><li><a href="#22-캐시-적용">2.2 캐시 적용</a></li><li><a href="#23-캐시-시간-초과">2.3 캐시 시간 초과</a></li></ul></li><li><a href="#3-검증-헤더와-조건부-요청">3. 검증 헤더와 조건부 요청</a><ul><li><a href="#31-las-modified-if-modified-since">3.1 Las-Modified, if-modified-since</a></li><li><a href="#32-last-modified-if-modified-since-단점">3.2 Last-Modified, If-Modified-Since 단점</a></li><li><a href="#33-etag-if-none-match">3.3 **ETag, If-None-Match**</a></li></ul></li><li><a href="#4-캐시와-조건부-요청-헤더">4. 캐시와 조건부 요청 헤더</a><ul><li><a href="#캐시-제어-헤더">캐시 제어 헤더</a></li><li><a href="#41-cache-control">4.1 Cache-Control</a></li><li><a href="#42-pragma-캐시제어-하위-호환">4.2 Pragma: 캐시제어 (하위 호환)</a></li><li><a href="#43-expires-캐시-유효-기간-하위-호환">4.3 Expires: 캐시 유효 기간 (하위 호환)</a></li></ul></li><li><a href="#5-프록시-캐시">5. 프록시 캐시</a></li><li><a href="#6-캐시-무효화">6. 캐시 무효화</a><ul><li><a href="#61-확실한-캐시-무효화-응답">6.1 확실한 캐시 무효화 응답</a></li><li><a href="#62-no-cache와-must-revalidate의-차이">6.2 no-cache와 must-revalidate의 차이</a></li></ul></li></ul>

            </nav>
          </aside>
        
        <h2 id="1-쿠키">1. 쿠키</h2>

<ul>
  <li>Set-Cookie: 서버에서 클라이언트로 쿠키 전달(응답)</li>
  <li>Cookie: 클라이언트가 서버에서 받은 쿠키를 저장하고, HTTP 요청시 서버로 전달</li>
</ul>

<p><br /></p>

<h3 id="stateless">Stateless</h3>

<ul>
  <li>HTTP는 무상태 프로토콜</li>
  <li>클라이언트와 서버가 요청과 응답을 주고 받으면 연결이 끊어짐</li>
  <li>클라이언트가 다시 요청하면 서버는 이전 요청을 기억하지 못함</li>
  <li>클라이언트와 서버는 서로 상태를 유지하지 않는다</li>
</ul>

<p><br /></p>

<p>대안으로 모든 요청에 정보를 넘기는 방법이 있지만 이 방법은 문제가 있다. 모든 요청에 사용자 정보가 포함되도록 개발해야함. 이를 해결하기 위한 방법이 <code class="language-plaintext highlighter-rouge">쿠키</code></p>

<p><br /></p>

<h3 id="11-사용법">1.1 사용법</h3>

<p>서버 측에서 Set-Cookie라는 필드에 정보들을 담아 응답하면 웹 브라우저는 해당 정보를 쿠키에 저장함. 쿠키는 보통 로그인 세션관리에서 많이 사용된다.</p>

<p><img src="https://user-images.githubusercontent.com/79130276/179342695-b4709d82-0440-4770-ac55-e448220f3793.png" alt="스크린샷 2022-07-16 오전 12 14 16" /></p>

<p><img src="https://user-images.githubusercontent.com/79130276/179342696-a8048939-53e2-49de-b278-1c7ffccbc2fd.png" alt="스크린샷 2022-07-16 오전 12 14 26" /></p>

<p><br /></p>

<h3 id="12-주의사항">1.2 주의사항</h3>

<ol>
  <li>쿠키 정보는 항상 서버에 전송되기때문에  네트워크 트래픽 추가로 발생된다. 따라서, 최소한의 정보만 사용(세션 id, 인증 토큰)하는 것이 좋다.
    <ul>
      <li>서버에 전송하지 않고, 웹 브라우저 내부에 데이터를 저장하고 싶으면 웹 스토리지 (localStorage, sessionStorage) 참고</li>
    </ul>
  </li>
  <li>보안에 민감한 데이터는 쿠키에 저장하면 안됨(주민번호, 신용카드 번호 등등)</li>
</ol>

<p><br /></p>

<h3 id="참고-웹-스토리지web-storage">[참고] 웹 스토리지(Web Storage)</h3>

<p>서버에 전송할 필요없이 클라이언트 측에서만 관리하면 되는 민감하지 않 은 데이터들은 웹 스토리지(localStorage, sessionStorage)를 사용할 수 있음.</p>

<p><br /></p>

<ol>
  <li>Local Storage</li>
</ol>

<ul>
  <li>데이터의 지속성이 영구적이다</li>
  <li>window.localStorage에 위치함</li>
  <li>모든 값은 문자열로 변환되어 저장됨</li>
  <li>Object 타입도 toString의 결과가 저장된([object Object])
    <ul>
      <li>JSON.stringify를 이용해 직렬화 하여 사용할 수 있다</li>
    </ul>
  </li>
</ul>

<ol>
  <li>Session Storage</li>
</ol>

<ul>
  <li>윈도우&amp;브라우저 탭을 닫을 경우 모두 삭제됨</li>
  <li>window.sessionStorage에 위치함</li>
  <li>사용법은 LocalStorage와 동일함</li>
</ul>

<p><br /></p>

<h3 id="13-쿠키의-생명주기">1.3 쿠키의 생명주기</h3>

<ul>
  <li><strong>**Expires, max-age</strong>**를 이용해 생명주기를 관리</li>
  <li>Set-Cookie: <strong>expires</strong>=Sat, 26-Dec-2020 04:39:21 GMT
    <ul>
      <li>만료일이 되면 쿠키 삭제</li>
    </ul>
  </li>
  <li>Set-Cookie: <strong>max-age</strong>=3600 (3600초)
    <ul>
      <li>3600초 이후 삭제됨</li>
      <li>0이나 음수를 지정하면 쿠키 삭제</li>
    </ul>
  </li>
  <li>세션 쿠키: 만료 날짜를 생략하면 브라우저 종료시 까지만 유지</li>
  <li>영속 쿠키: 만료 날짜를 입력하면 해당 날짜까지 유지</li>
</ul>

<p><br /></p>

<h3 id="14-쿠키의-도메인">1.4 쿠키의 도메인</h3>

<ul>
  <li>domain 필드에 명시한 도메인 (+ 서브 도메인)정보로 쿠키의 접근 가능여부가 결정됨</li>
  <li>domain=example.org
    <ul>
      <li>example.org는 쿠키가 접근이 가능하다</li>
      <li>dev.example.org도 서브도메인으로 포함되기에 쿠키 접근이 가능함</li>
    </ul>
  </li>
  <li>해당 필드 생략 시 현재 문서 기준 도메인만 적용됨
    <ul>
      <li>example.org에서 쿠키를 생성하면 해당 domain만 쿠키 접근이 가능하고 그 외 서브 도메인은 쿠키 접근이 불가하다
        <ul>
          <li>example.org 에서만 쿠키 접근</li>
          <li>dev.example.org는 쿠키 미접근</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h3 id="15-쿠키-경로-지정">1.5 쿠키 경로 지정</h3>

<ul>
  <li>path 필드에 작성한 경로와 그 하위 경로 페이지만 쿠키 접근이 가능</li>
  <li><strong>일반적으로 path=/ 루트로 지정</strong></li>
  <li>예)
    <ul>
      <li><strong>path=/home 지정</strong></li>
      <li>/home -&gt; 가능</li>
      <li>/home/level1 -&gt; 가능</li>
      <li>/home/level1/level2 -&gt; 가능</li>
      <li>/hello -&gt; 불가능</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h3 id="16-쿠키-보안-지정">1.6 쿠키 보안 지정</h3>

<ul>
  <li>Secure
    <ul>
      <li>쿠키는 http, https를 구분하지 않고 전송</li>
      <li>Secure를 적용하면 https인 경우에만 전송</li>
    </ul>
  </li>
  <li>HttpOnly
    <ul>
      <li>XSS 공격 방지</li>
      <li>자바스크립트에서 접근 불가(document.cookie)</li>
      <li>HTTP 전송에만 사용</li>
    </ul>
  </li>
  <li>SameSite
    <ul>
      <li>XSRF 공격 방지</li>
      <li>요청 도메인과 쿠키에 설정된 도메인이 같은 경우만 쿠키 전송</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<blockquote>
  <p><strong>참고</strong> XSS(Cross-Site Scripting)
<br />
관리자가 아닌 기타 사용자가 웹 사이트에 스크립트를 삽입(Injection)하는 공격 기법</p>

</blockquote>

<p><br /></p>

<blockquote>
  <p><strong>참고</strong> XSRF(Cross-Site Request Forgery)
<br />
CSRF라고도 함. 쿠키만으로 인증하는 서비스의 취약점을 이용해 서비스에 특정 명령을 요청하는 공격</p>

</blockquote>

<p><br /></p>

<h2 id="2-캐시">2. 캐시</h2>

<h3 id="21-캐시가-없을-때">2.1 캐시가 없을 때</h3>

<ul>
  <li>데이터가 변경되지 않아도 계속 네트워크를 통해서 데이터를 다운로드 받아야 함</li>
  <li>인터넷 네트워크는 매우 느리고 비싸다</li>
  <li>브라우저 로딩 속도가 느리다</li>
  <li>느린 사용자 경험</li>
</ul>

<p><br /></p>

<h3 id="22-캐시-적용">2.2 캐시 적용</h3>

<ul>
  <li>캐시 덕분에 캐시 가능 시간동안 네트워크를 사용하지 않아도 됨</li>
  <li>비싼 네트워크 사용량을 줄일 수 있다</li>
  <li>브라우저 로딩 속도가 매우 빠름</li>
  <li>빠른 사용자 경험</li>
</ul>

<p><br /></p>

<h3 id="23-캐시-시간-초과">2.3 캐시 시간 초과</h3>

<ul>
  <li>캐시 유효 시간이 초과되면, 서버를 통해 데이터를 다시 조회하고, 캐시를 갱신한다</li>
  <li>이때 다시 네트워크 다운로드가 발생함</li>
</ul>

<p><br /></p>

<p>그러나, 캐시를 사용해도 다음과 같은 문제가 존재한다.</p>

<p>캐시의 시간이 초과되면 클라이언트는 서버에게 다시 자원을 요청할 수 밖에 없다. 그런데 요청하는 데이터가 변하지 않고 같은 데이터라고 가정한다면 이는 효율적이지 않고 번거롭다. 이를 보완하기 위해 <code class="language-plaintext highlighter-rouge">검증 헤더와 조건부 요청</code>이 등장한다.</p>

<p><br /></p>

<ul>
  <li>캐시 만료 후에도 서버에서 데이터를 변경하지 않음</li>
  <li>데이터를 전송하는 대신 저장해 두었던 캐시를 재사용 할 수 있다</li>
  <li>단, 클라이언트의 데이터와 서버의 데이터가 같다는 사실을 확인할 수 있는 방법 필요</li>
</ul>

<p><br /></p>

<h2 id="3-검증-헤더와-조건부-요청">3. 검증 헤더와 조건부 요청</h2>

<ul>
  <li>캐시 유효 시간이 초과해도, 서버의 데이터가 갱신되지 않으면</li>
  <li>304 Not Modified + 헤더 메타 정보만 응답한다 (바디X)</li>
  <li>클라이언트는 서버가 보낸 응답 헤더 정보로 캐시의 메타 정보를 갱신</li>
  <li>클라이언트는 캐시에 저장되어 있는 <strong>데이터 재활용</strong></li>
  <li>결과적으로 네트워크 다운로드가 발생하지만 <strong>용량이 적은 헤더</strong> 정보만 다운로드</li>
  <li>매우 <strong>실용적</strong>인 해결책</li>
  <li>검증 헤더
    <ul>
      <li>캐시 데이터와 서버 데이터가 같은지 검증하는 데이터</li>
      <li>Last-Modified, ETag</li>
    </ul>
  </li>
  <li>조건부 요청 헤더
    <ul>
      <li>검증 헤더로 조건에 따른 분기</li>
      <li>If-Modified-Since: Last-Modified 사용</li>
      <li>If-None-Match: ETag 사용</li>
      <li>조건이 만족하면 200 OK</li>
      <li>조건이 만족하지 않으면 304 Not Modified</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h3 id="31-las-modified-if-modified-since">3.1 <strong>Las-Modified, if-modified-since</strong></h3>

<ul>
  <li>검증 헤더: Last-Modified</li>
  <li>조건부 요청: if-modified-since</li>
  <li>If-Modified-Since
    <ul>
      <li>데이터 미변경 예시
        <ul>
          <li>304 Not Modified, 헤더 데이터만 전송(body 미포함)</li>
          <li>전송 용량 0.1M (헤더 0.1M, 바디 1.0M)</li>
        </ul>
      </li>
      <li>데이터 변경 예시
        <ul>
          <li>200 OK, 모든 데이터 전송(body 포함)</li>
          <li>전송 용량 1.1M (헤더 0.1M, 바디 1.0M)</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><img src="https://user-images.githubusercontent.com/79130276/179359266-7c360c14-f3df-40c4-8a56-998c1066a4c6.png" alt="스크린샷 2022-07-16 오후 3 43 34" /></p>

<p><img src="https://user-images.githubusercontent.com/79130276/179359271-300b823b-b2bf-475a-a960-5414927649bc.png" alt="스크린샷 2022-07-16 오후 3 43 52" /></p>

<p><br /></p>

<h3 id="32-last-modified-if-modified-since-단점">3.2 Last-Modified, If-Modified-Since 단점</h3>

<ul>
  <li>1초 미만(0.x초) 단위로 캐시 조정이 불가능</li>
  <li>날짜 기반의 로직 사용</li>
  <li>데이터를 수정해서 날짜가 다르지만, 같은 데이터를 수정해서 데이터 결과가 똑같은 경우
    <ul>
      <li>a → b로 수정 후, 다시 b → a로 수정하면 수정해서 날짜는 바뀌었지만 결국 내용은 같음</li>
    </ul>
  </li>
  <li>서버에서 별도의 캐시 로직을 관리하고 싶은 경우
    <ul>
      <li>예) 스페이스나 주석처럼 크게 영향이 없는 변경에서 캐시를 유지하고 싶은 경우</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h3 id="33-etag-if-none-match">3.3 <strong>**ETag, If-None-Match</strong>**</h3>

<ul>
  <li>검증 헤더: ETag(Entity Tag)</li>
  <li>조건부 요청: if-none-match</li>
  <li>캐시용 데이터에 임의의 고유한 버전 이름을 달아둠
    <ul>
      <li>예) ETag: “v1.0”, ETag: “a2jiodwjekjl3”</li>
    </ul>
  </li>
  <li>데이터가 변경되면 이 이름을 바꾸어서 변경함(Hash를 다시 생성)
    <ul>
      <li>예) ETag: “aaaaa” -&gt; ETag: “bbbbb”</li>
    </ul>
  </li>
  <li>진짜 단순하게 ETag만 보내서 같으면 유지, 다르면 다시 받기!</li>
  <li><strong>캐시 제어 로직을 서버에서 완전히 관리</strong></li>
  <li>클라이언트는 단순히 이 값을 서버에 제공(클라이언트는 캐시 메커니즘을 모름)</li>
  <li>예)
    <ul>
      <li>서버는 배타 오픈 기간인 3일 동안 파일이 변경되어도 ETag를 동일하게 유지</li>
      <li>애플리케이션 배포 주기에 맞추어 ETag 모두 갱신</li>
    </ul>
  </li>
</ul>

<p><img src="https://user-images.githubusercontent.com/79130276/179359272-76bf607f-9768-4bea-9c33-92ad48a23432.png" alt="스크린샷 2022-07-16 오후 4 03 26" /></p>

<p><img src="https://user-images.githubusercontent.com/79130276/179359274-8f33ee99-2c54-4728-a4c4-4ed5f939236d.png" alt="스크린샷 2022-07-16 오후 4 03 39" /></p>

<p><br /></p>

<h2 id="4-캐시와-조건부-요청-헤더">4. 캐시와 조건부 요청 헤더</h2>

<h3 id="캐시-제어-헤더">캐시 제어 헤더</h3>

<ul>
  <li>Cache-Control: 캐시 제어</li>
  <li>Pragma: 캐시 제어(하위 호환)</li>
  <li>Expires: 캐시 유효 기간(하위 호환)</li>
</ul>

<p><br /></p>

<h3 id="41-cache-control">4.1 Cache-Control</h3>

<ul>
  <li>Cache-Control: max_age
    <ul>
      <li>캐시 유효 시간, 초 단위</li>
    </ul>
  </li>
  <li>Cache-Control: no-cache
    <ul>
      <li>데이터는 캐시해도 되지만, 항상 원(origin) 서버에 검증하고 사용</li>
    </ul>
  </li>
  <li>Cache-Control: no-store
    <ul>
      <li>데이터에 민감한 정보가 있으므로 저장하면 안됨 (메모리에서 사용하고 최대한 빨리 삭제)</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h3 id="42-pragma-캐시제어-하위-호환">4.2 Pragma: 캐시제어 (하위 호환)</h3>

<ul>
  <li>Pragma: no-cache</li>
  <li>HTTP 1.0 하위 호환</li>
</ul>

<p><br /></p>

<h3 id="43-expires-캐시-유효-기간-하위-호환">4.3 Expires: 캐시 유효 기간 (하위 호환)</h3>

<ul>
  <li>캐시 만료일을 정확한 날짜로 지정</li>
  <li>HTTP 1.0부터 사용</li>
  <li>지금은 더 유연한 Cache-Control: max-age 권장</li>
  <li>Cache-Control: max-age와 함께 사용하면 Expires는 무시</li>
</ul>

<p><br /></p>

<h2 id="5-프록시-캐시">5. 프록시 캐시</h2>

<p>클라이언트와 원(origin) 서버의 거리가 멀면 응답시간이 많이 소요되는 경우 클라이언트와 원 서버 사이에 프록시 캐시 서버를 둠으로써 응답시간을 줄이는 방식</p>

<p>클라이언트로부터 요청되는 자원에 대해 프록시 캐시 서버에서 캐시를 저장하여 제공함으로써 여러 사람이 찾는 자료일수록 이미 캐시에 등록되어 있기에 빠른 속도로 자원을 받을 수 있음</p>

<p>클라이언트에서 사용되는 캐시는 해당 클라이언트에서만 사용되기에 <code class="language-plaintext highlighter-rouge">private 캐시</code>라 부르고 프록시 캐시 서버에서 사용되는 캐시는 여러 클라이언트들에서 사용하기 때문에 <code class="language-plaintext highlighter-rouge">public 캐시</code>라 부름</p>

<p><img src="https://user-images.githubusercontent.com/79130276/179359278-16019c92-c171-4592-b677-ac4366d56c1c.png" alt="스크린샷 2022-07-16 오후 7 21 03" /></p>

<ul>
  <li>Cache-Control: public
    <ul>
      <li>응답이 public 캐시에 저장되어도 됨</li>
    </ul>
  </li>
  <li>Cache-Control: private
    <ul>
      <li>응답이 해당 사용자만을 위한 것임, private 캐시에 저장해야 함(기본값)</li>
    </ul>
  </li>
  <li>Cache-Control: s-maxage
    <ul>
      <li>프록시 캐시에만 적용되는 max-age</li>
    </ul>
  </li>
  <li>Age: 60 <em>**</em>(HTTP 헤더)
    <ul>
      <li>오리진 서버에서 응답 후 프록시 캐시 내에 머문 시간(초)</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h2 id="6-캐시-무효화">6. 캐시 무효화</h2>

<h3 id="61-확실한-캐시-무효화-응답">6.1 확실한 캐시 무효화 응답</h3>

<ul>
  <li>민감한 정보에 대해 캐시 무효화를 해야할 때 사용</li>
  <li>Cache-Control: no-cache, no-store, must-revalidate</li>
  <li>Pragma: no-cache
    <ul>
      <li>HTTP 1.0 하위 호환</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<ul>
  <li><strong>Cache-Control: no-cache</strong>
    <ul>
      <li>데이터는 캐시해도 되지만, 항상 <strong>원 서버에 검증</strong>하고 사용(이름에 주의!)</li>
    </ul>
  </li>
  <li><strong>Cache-Control: no-store</strong>
    <ul>
      <li>데이터에 민감한 정보가 있으므로 저장하면 안됨
  (메모리에서 사용하고 최대한 빨리 삭제)</li>
    </ul>
  </li>
  <li><strong>Cache-Control: must-revalidate</strong>
    <ul>
      <li>캐시 만료 후 최초 조회시 <strong>원 서버에 검증</strong>해야함</li>
      <li>원 서버 접근 실패시 반드시 오류가 발생해야함 - 504(Gateway Timeout)</li>
      <li>must-revalidate는 캐시 유효 시간이라면 캐시를 사용함</li>
    </ul>
  </li>
  <li><strong>Pragma: no-cache</strong>
    <ul>
      <li>HTTP 1.0 하위 호환</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h3 id="62-no-cache와-must-revalidate의-차이">6.2 no-cache와 must-revalidate의 차이</h3>

<p>둘 경우 모두 원 서버에 검증을 해야한다는 점은 같지만 차이점은 순간 네트워크가 단절되어 원 서버에 접근이 불가할 때 발생한다.</p>

<p>네트워크 단절이 발생하면,</p>

<p><strong>no-cache</strong>의 경우에는 서버 설정에 따라 <strong>캐시 데이터를 반환</strong>할 수 있다. (오류 보다는 오래된 데이터를 보여주려고 함)</p>

<p><strong>must-revalidate</strong>의 경우에는 <strong>항상 오류가 발생</strong>해야 한다. (504 error)</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> 카테고리: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#http" class="page__taxonomy-item" rel="tag">Http</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> 태그: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#http" class="page__taxonomy-item" rel="tag">Http</a><span class="sep">, </span>
    
      <a href="/tags/#web" class="page__taxonomy-item" rel="tag">Web</a>
    
    </span>
  </p>



        <!--

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> 작성일</strong> <time datetime="2022-07-16T00:00:00+09:00">July 16, 2022</time></p>

작성일-->
      </footer>

      

      <!-- 기존 코드

  <nav class="pagination">
    
      <a href="/java/Java-JVM/" class="pagination--pager" title="JVM(Java Virtual Machine)
">이전</a>
    
    
      <a href="/http/SsrCsr/" class="pagination--pager" title="SSR, CSR
">다음</a>
    
  </nav>

-->


<!--같은 카테고리내에서 다음으로 이동하는 것.-->



  

  

  
  	
  	
  	
  	
  	


  <nav class="pagination_prev_next" style="padding-top: 5px; padding-bottom: 5px;">
    
      <a href="/http/HTTPAPI/" class="pagination_prev_next--pager"><span class="prev_next">이전 글  &nbsp</span>HTTP API</a>
    
    
      <a href="/http/SsrCsr/" class="pagination_prev_next--pager"><span class="prev_next">다음 글  &nbsp  </span>SSR, CSR</a>
    
  </nav>


    </div>

    
  </article>

  
  
</div>
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>팔로우:</strong></li>
    

    
      
        
          <li><a href="https://github.com/yessm621" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> 피드</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 승미 <a href="https://jekyllrb.com" rel="nofollow"></a>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>










  </body>
</html>
